<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cmcc.paymentclean.mapper.PcacPersonRiskSubmitInfoMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.cmcc.paymentclean.entity.PcacPersonRiskSubmitInfo">
        <id column="pcac_person_risk_submit_info_id" property="pcacPersonRiskSubmitInfoId" />
        <result column="cus_property" property="cusProperty" />
        <result column="risk_type" property="riskType" />
        <result column="mobile_no" property="mobileNo" />
        <result column="mac" property="mac" />
        <result column="imei" property="imei" />
        <result column="bank_no" property="bankNo" />
        <result column="open_bank" property="openBank" />
        <result column="cus_name" property="cusName" />
        <result column="doc_type" property="docType" />
        <result column="doc_code" property="docCode" />
        <result column="ip" property="ip" />
        <result column="address" property="address" />
        <result column="telephone" property="telephone" />
        <result column="is_transfer" property="isTransfer" />
        <result column="rec_name" property="recName" />
        <result column="rec_doc_type" property="recDocType" />
        <result column="rec_doc_code" property="recDocCode" />
        <result column="rec_bank_no" property="recBankNo" />
        <result column="rec_open_bank" property="recOpenBank" />
        <result column="rec_host_area" property="recHostArea" />
        <result column="email" property="email" />
        <result column="valid_date" property="validDate" />
        <result column="occurtimeb" property="occurtimeb" />
        <result column="occurtimee" property="occurtimee" />
        <result column="occurchan" property="occurchan" />
        <result column="occurarea" property="occurarea" />
        <result column="note" property="note" />
        <result column="org_id" property="orgId" />
        <result column="rep_date" property="repDate" />
        <result column="rep_type" property="repType" />
        <result column="rep_person" property="repPerson" />
        <result column="source_channel" property="sourceChannel" />
        <result column="disk_number" property="diskNumber" />
        <result column="currency" property="currency" />
        <result column="amount" property="amount" />
        <result column="risk_find_time" property="riskFindTime" />
        <result column="usrNo" property="usrNo" />
        <result column="operator" property="operator" />
        <result column="operate_time" property="operateTime" />
        <result column="submit_time" property="submitTime" />
        <result column="submit_status" property="submitStatus" />
        <result column="result_status" property="resultStatus" />
        <result column="result_code" property="resultCode" />
        <result column="msg_detail" property="msgDetail" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        pcac_person_risk_submit_info_id, cus_property, risk_type, mobile_no, mac, imei, bank_no, open_bank, cus_name, doc_type, doc_code, ip,
        address, telephone, is_transfer, rec_name, rec_doc_type, rec_doc_code, rec_bank_no, rec_open_bank, rec_host_area, email, valid_date, occurtimeb,
        occurtimee, occurchan, occurarea, note, org_id, rep_date, rep_type, rep_person, source_channel, disk_number, currency, amount, risk_find_time, usrNo,
        operator, operate_time, submit_time, submit_status, result_status, result_code, msg_detail
    </sql>

    <select id="pagePcacPersonRiskSubmitInfo" resultType="com.cmcc.paymentclean.entity.dto.response.RiskPersonResp"
            parameterType="com.cmcc.paymentclean.entity.dto.resquest.RiskPersonReq">
        SELECT
        <include refid="Base_Column_List"/>,t.msg_detail as failureReason
        FROM
        pcac_person_risk_submit_info t
        WHERE
        1=1
        <if test="req.usrNo !=null and req.usrNo !=''">
            and t.usrNo=#{req.usrNo}
        </if>
        <if test="req.mobileNo !=null and req.mobileNo !=''">
            and t.mobile_No=#{req.mobileNo}
        </if>
        <if test="req.docType !=null and req.docType !=''">
            and t.doc_Type=#{req.docType}
        </if>
        <if test="req.docCode !=null and req.docCode !=''">
            and t.doc_Code=#{req.docCode}
        </if>
        <if test="req.submitStatus !=null and req.submitStatus !=''">
            and t.submit_Status=#{req.submitStatus}
        </if>
        <if test="req.operator !=null and req.operator !=''">
            and t.operator=#{req.operator}
        </if>
        <if test="req.operateStartTime!=null ">
            <![CDATA[  and DATE_FORMAT(t.operate_time, '%Y-%m-%d') >= DATE_FORMAT(#{req.operateStartTime}, '%Y-%m-%d')    ]]>
        </if>
        <if test="req.operateEndTime!=null ">
            <![CDATA[  and DATE_FORMAT(t.operate_time, '%Y-%m-%d') <= DATE_FORMAT(#{req.operateEndTime}, '%Y-%m-%d')    ]]>
        </if>
        <if test="req.submitStartTime!=null ">
            <![CDATA[  and DATE_FORMAT(t.submit_time, '%Y-%m-%d') >= DATE_FORMAT(#{req.submitStartTime}, '%Y-%m-%d')    ]]>
        </if>
        <if test="req.submitEndTime!=null ">
            <![CDATA[  and DATE_FORMAT(t.submit_time, '%Y-%m-%d') <= DATE_FORMAT(#{req.submitEndTime}, '%Y-%m-%d')    ]]>
        </if>
    </select>


    <select id="selectPcacPersonRiskSubmitInfoList" resultMap="BaseResultMap">

        select <include refid="Base_Column_List"/>  from  pcac_person_risk_submit_info
        <where> submit_status = '0'</where>
    </select>

</mapper>
